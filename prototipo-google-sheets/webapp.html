<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üéØ Selecci√≥n de Metas IBI - Estudiantes 1er Ingreso</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #4285f4 0%, #34a853 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .content {
            padding: 40px;
        }

        .step {
            display: none;
            animation: fadeIn 0.5s ease-in;
        }

        .step.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .form-group {
            margin-bottom: 25px;
        }

        .form-group label {
            display: block;
            font-weight: 600;
            margin-bottom: 8px;
            color: #333;
        }

        .form-group input, .form-group select {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e1e5e9;
            border-radius: 10px;
            font-size: 16px;
            transition: border-color 0.3s ease;
        }

        .form-group input:focus, .form-group select:focus {
            outline: none;
            border-color: #4285f4;
        }

        .dimension-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .dimension-card {
            border: 2px solid #e1e5e9;
            border-radius: 15px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            background: white;
        }

        .dimension-card:hover {
            border-color: #4285f4;
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(66, 133, 244, 0.1);
        }

        .dimension-card.selected {
            border-color: #4285f4;
            background: #f8f9ff;
        }

        .dimension-card.selected.priority-1 {
            border-color: #ea4335;
            background: #fff5f5;
        }

        .dimension-card.selected.priority-2 {
            border-color: #fbbc04;
            background: #fffbf0;
        }

        .dimension-card.selected.priority-3 {
            border-color: #34a853;
            background: #f0fff4;
        }

        .dimension-emoji {
            font-size: 2em;
            margin-bottom: 10px;
        }

        .dimension-title {
            font-size: 1.2em;
            font-weight: 600;
            margin-bottom: 8px;
            color: #333;
        }

        .dimension-description {
            color: #666;
            font-size: 0.9em;
            line-height: 1.4;
        }

        .priority-badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 20px;
            font-size: 0.8em;
            font-weight: 600;
            margin-top: 10px;
        }

        .priority-1 .priority-badge {
            background: #ea4335;
            color: white;
        }

        .priority-2 .priority-badge {
            background: #fbbc04;
            color: #333;
        }

        .priority-3 .priority-badge {
            background: #34a853;
            color: white;
        }

        .btn {
            background: #4285f4;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 10px;
        }

        .btn:hover {
            background: #3367d6;
            transform: translateY(-2px);
        }

        .btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        .btn-secondary {
            background: #6c757d;
        }

        .btn-secondary:hover {
            background: #5a6268;
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #e1e5e9;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e1e5e9;
            border-radius: 4px;
            margin-bottom: 20px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4285f4, #34a853);
            transition: width 0.3s ease;
        }

        .recommendations {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .recommendation-card {
            border: 2px solid #e1e5e9;
            border-radius: 15px;
            padding: 20px;
            background: white;
            transition: all 0.3s ease;
        }

        .recommendation-card:hover {
            border-color: #4285f4;
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(66, 133, 244, 0.1);
        }

        .recommendation-header {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }

        .recommendation-badge {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.8em;
            font-weight: 600;
            margin-right: 10px;
        }

        .badge-priority {
            background: #ea4335;
            color: white;
        }

        .badge-complementary {
            background: #fbbc04;
            color: #333;
        }

        .badge-longitudinal {
            background: #34a853;
            color: white;
        }

        .recommendation-title {
            font-size: 1.1em;
            font-weight: 600;
            color: #333;
            margin-bottom: 10px;
        }

        .recommendation-description {
            color: #666;
            font-size: 0.9em;
            line-height: 1.4;
            margin-bottom: 15px;
        }

        .recommendation-actions {
            display: flex;
            gap: 10px;
        }

        .btn-small {
            padding: 8px 16px;
            font-size: 14px;
        }

        .btn-outline {
            background: transparent;
            border: 2px solid #4285f4;
            color: #4285f4;
        }

        .btn-outline:hover {
            background: #4285f4;
            color: white;
        }

        .summary {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 30px;
        }

        .summary h3 {
            color: #333;
            margin-bottom: 15px;
        }

        .summary-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid #e1e5e9;
        }

        .summary-item:last-child {
            border-bottom: none;
        }

        .loading {
            text-align: center;
            padding: 40px;
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #4285f4;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        @keyframes slideOut {
            from { transform: translateX(0); opacity: 1; }
            to { transform: translateX(100%); opacity: 0; }
        }

        .error {
            background: #fff5f5;
            border: 1px solid #fed7d7;
            color: #c53030;
            padding: 15px;
            border-radius: 10px;
            margin: 20px 0;
        }

        .success-message {
            text-align: center;
            padding: 40px 20px;
        }
        
        .success-icon {
            font-size: 4em;
            margin-bottom: 20px;
        }
        
        .success-message h2 {
            color: #2e7d32;
            margin-bottom: 20px;
        }
        
        .email-address {
            background: #e3f2fd;
            padding: 15px;
            border-radius: 10px;
            font-size: 1.2em;
            margin: 20px 0;
            border-left: 4px solid #2196f3;
        }
        
        .next-steps {
            background: #e8f5e8;
            padding: 20px;
            border-radius: 10px;
            margin: 30px 0;
            text-align: left;
        }
        
        .next-steps h3 {
            color: #2e7d32;
            margin-bottom: 15px;
        }
        
        .next-steps ul {
            margin: 0;
            padding-left: 20px;
        }
        
        .next-steps li {
            margin-bottom: 8px;
        }
        
        .email-help {
            background: #fff3cd;
            padding: 20px;
            border-radius: 10px;
            margin: 30px 0;
            border-left: 4px solid #ffc107;
        }
        
        .email-help h4 {
            color: #856404;
            margin-bottom: 15px;
        }
        
        .resend-section {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            align-items: center;
        }
        
        .resend-section input {
            flex: 1;
            padding: 10px;
            border: 2px solid #e1e5e9;
            border-radius: 8px;
            font-size: 16px;
        }
        
        .resend-section input:focus {
            outline: none;
            border-color: #4285f4;
        }

        @media (max-width: 768px) {
            .container {
                margin: 10px;
                border-radius: 15px;
            }
            
            .content {
                padding: 20px;
            }
            
            .dimension-grid {
                grid-template-columns: 1fr;
            }
            
            .recommendations {
                grid-template-columns: 1fr;
            }
            
            .resend-section {
                flex-direction: column;
            }
            
            .resend-section input {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üéØ Selecci√≥n de Metas IBI</h1>
            <p>Identifica tus 3 dimensiones prioritarias y recibe recomendaciones personalizadas</p>
        </div>

        <div class="content">
            <!-- Barra de progreso -->
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill" style="width: 20%"></div>
            </div>

            <!-- Paso 1: Informaci√≥n del estudiante -->
            <div class="step active" id="step1">
                <h2>üìù Informaci√≥n del Estudiante</h2>
                <p style="color: #666; margin-bottom: 30px;">Completa tu informaci√≥n para personalizar las recomendaciones</p>
                
                <div class="form-group">
                    <label for="matricula">Matr√≠cula *</label>
                    <input type="text" id="matricula" placeholder="Ej: A1234567" required>
                </div>
                
                <div class="form-group">
                    <label for="nombre">Nombre completo *</label>
                    <input type="text" id="nombre" placeholder="Tu nombre completo" required>
                </div>
                
                <div class="navigation">
                    <div></div>
                    <button class="btn" onclick="nextStep()">Continuar</button>
                </div>
            </div>

            <!-- Paso 2: Selecci√≥n de dimensiones -->
            <div class="step" id="step2">
                <h2>üéØ Selecciona tus 3 Dimensiones Prioritarias</h2>
                <p style="color: #666; margin-bottom: 30px;">Elige las 3 dimensiones del bienestar que consideras m√°s importantes para tu desarrollo</p>
                
                <div class="dimension-grid" id="dimensionGrid">
                    <!-- Las dimensiones se cargar√°n din√°micamente -->
                </div>
                
                <div class="navigation">
                    <button class="btn btn-secondary" onclick="prevStep()">Anterior</button>
                    <button class="btn" id="nextBtn2" onclick="nextStep()" disabled>Continuar</button>
                </div>
            </div>

            <!-- Paso 3: Resumen y recomendaciones -->
            <div class="step" id="step3">
                <h2>üìä Tus Recomendaciones Personalizadas</h2>
                <p style="color: #666; margin-bottom: 30px;">Basado en tus selecciones, aqu√≠ tienes metas espec√≠ficas para tu desarrollo</p>
                
                <div class="summary" id="summary">
                    <!-- El resumen se generar√° din√°micamente -->
                </div>
                
                <div class="loading" id="loading">
                    <div class="spinner"></div>
                    <p>Generando tus recomendaciones personalizadas...</p>
                </div>
                
                <div class="recommendations" id="recommendations" style="display: none;">
                    <!-- Las recomendaciones se cargar√°n din√°micamente -->
                </div>
                
                <div class="navigation">
                    <button class="btn btn-secondary" onclick="prevStep()">Anterior</button>
                    <button class="btn" onclick="saveResults()">Guardar Resultados</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Datos de las dimensiones
        const DIMENSIONS = {
            'Intelectual': {
                emoji: 'üß†',
                description: 'Desarrollo acad√©mico y habilidades de estudio'
            },
            'Ocupacional': {
                emoji: 'üíº',
                description: 'Claridad vocacional y preparaci√≥n profesional'
            },
            'Emocional': {
                emoji: '‚ù§Ô∏è',
                description: 'Bienestar emocional y adaptaci√≥n universitaria'
            },
            'Social': {
                emoji: 'üë•',
                description: 'Relaciones interpersonales y vida social'
            },
            'F√≠sica': {
                emoji: 'üí™',
                description: 'Salud f√≠sica y bienestar corporal'
            },
            'Espiritual': {
                emoji: 'üôè',
                description: 'Prop√≥sito de vida y valores personales'
            },
            'Financiera': {
                emoji: 'üí∞',
                description: 'Gesti√≥n de recursos econ√≥micos y planificaci√≥n financiera'
            }
        };

        // Base de datos de metas (completa con 4 metas por dimensi√≥n)
        const GOALS_DATABASE = {
            'Intelectual': [
                {
                    id: 'PRIM_INT01',
                    title: 'Establecer rutina de estudio efectiva',
                    description: 'Crear un horario de estudio que incluya t√©cnicas de aprendizaje activo y espacios de concentraci√≥n para adaptarte al ritmo universitario.',
                    steps: 'Identificar horarios de mayor productividad, crear espacios de estudio libres de distracciones, implementar t√©cnica Pomodoro (25 min estudio + 5 min descanso), revisar y ajustar semanalmente.',
                    priority: 'high',
                    categoria: 'habitos_estudio',
                    tips: 'Tip: La consistencia es m√°s importante que la intensidad. Mejor 2 horas diarias constantes que 8 horas un d√≠a.',
                    mentorCommitment: 'Te ayudar√© a crear un horario de estudio que se adapte a tu estilo de aprendizaje y te facilitar√© t√©cnicas de estudio efectivas.'
                },
                {
                    id: 'PRIM_INT02',
                    title: 'Dominar t√©cnicas de lectura universitaria',
                    description: 'Desarrollar habilidades de lectura cr√≠tica y an√°lisis para textos acad√©micos m√°s complejos que en preparatoria.',
                    steps: 'Practicar lectura activa con subrayado estrat√©gico, crear mapas conceptuales, participar en discusiones de clase, aplicar t√©cnicas de s√≠ntesis y resumen.',
                    priority: 'high',
                    categoria: 'habitos_estudio',
                    tips: 'Tip: La lectura universitaria es diferente. No necesitas memorizar todo, sino entender conceptos clave y conexiones.',
                    mentorCommitment: 'Te compartir√© recursos de t√©cnicas de lectura y te ayudar√© a practicar con textos reales de tu carrera.'
                },
                {
                    id: 'PRIM_INT03',
                    title: 'Aprender un nuevo idioma o mejorar el ingl√©s',
                    description: 'Desarrollar competencias ling√º√≠sticas que abran oportunidades acad√©micas y profesionales.',
                    steps: 'Tomar curso de idioma en el TEC, practicar conversaci√≥n con nativos, consumir contenido en el idioma objetivo, establecer metas de progreso mensuales.',
                    priority: 'medium',
                    categoria: 'desarrollo_linguistico',
                    tips: 'Tip: Los idiomas son una inversi√≥n a largo plazo. La pr√°ctica diaria, aunque sea 15 minutos, es m√°s efectiva que sesiones largas espor√°dicas.',
                    mentorCommitment: 'Te ayudar√© a encontrar recursos de idiomas y te conectar√© con oportunidades de pr√°ctica conversacional.'
                },
                {
                    id: 'PRIM_INT03',
                    title: 'Buscar apoyos educativos en Tec Services',
                    description: 'Identificar y utilizar recursos educativos disponibles en Tec Services que se ajusten a tu perfil de aprendizaje.',
                    steps: 'Explorar servicios de tutor√≠a disponibles, identificar tu estilo de aprendizaje, solicitar apoyo en materias dif√≠ciles, participar en sesiones de estudio grupal.',
                    priority: 'high',
                    categoria: 'apoyos_educativos',
                    tips: 'Tip: Tec Services tiene muchos recursos gratuitos. No esperes a tener problemas para utilizarlos.',
                    mentorCommitment: 'Te ayudar√© a identificar los recursos m√°s adecuados para tu perfil y te guiar√© en c√≥mo aprovecharlos.'
                },
                {
                    id: 'PRIM_INT04',
                    title: 'Cuidar mi promedio y rendimiento acad√©mico',
                    description: 'Mantener un promedio acad√©mico s√≥lido y desarrollar estrategias para mejorar el rendimiento en todas las materias.',
                    steps: 'Establecer metas de calificaci√≥n por materia, revisar progreso semanalmente, identificar materias que requieren m√°s atenci√≥n, buscar ayuda temprano cuando sea necesario.',
                    priority: 'high',
                    categoria: 'rendimiento_academico',
                    tips: 'Tip: Un buen promedio te abre muchas puertas. Es mejor mantenerlo desde el principio que recuperarlo despu√©s.',
                    mentorCommitment: 'Te ayudar√© a establecer metas realistas de calificaci√≥n y te apoyar√© cuando necesites mejorar en alguna materia.'
                }
            ],
            'Ocupacional': [
                {
                    id: 'PRIM_OCC01',
                    title: 'Explorar opciones de carrera y especializaci√≥n',
                    description: 'Investigar diferentes trayectorias profesionales y especializaciones dentro de tu √°rea de estudio para tomar decisiones informadas.',
                    steps: 'Entrevistar a 3 profesionales del √°rea, investigar perfiles de egreso en Mi Tec, asistir a charlas de carrera, crear mapa de opciones profesionales, explorar especializaciones disponibles.',
                    priority: 'high',
                    categoria: 'claridad_vocacional',
                    tips: 'Tip: No necesitas decidir todo ahora, pero s√≠ explorar para tomar mejores decisiones en 2¬∞ y 3¬∞ semestre.',
                    mentorCommitment: 'Te conectar√© con profesionales de tu √°rea y te ayudar√© a organizar entrevistas informativas.'
                },
                {
                    id: 'PRIM_OCC02',
                    title: 'Buscar mentor√≠a acad√©mica y profesional',
                    description: 'Encontrar mentores que te gu√≠en en tu desarrollo acad√©mico y profesional durante la universidad.',
                    steps: 'Identificar profesores inspiradores, buscar programas de mentor√≠a del TEC, conectar con exalumnos, establecer relaciones con profesionales del √°rea.',
                    priority: 'high',
                    categoria: 'mentoria',
                    tips: 'Tip: Un buen mentor puede acelerar tu crecimiento y abrirte puertas. No tengas miedo de pedir ayuda.',
                    mentorCommitment: 'Te ayudar√© a identificar mentores potenciales y te guiar√© en c√≥mo establecer estas relaciones.'
                },
                {
                    id: 'PRIM_OCC03',
                    title: 'Desarrollar perfil profesional b√°sico',
                    description: 'Crear presencia profesional inicial en plataformas digitales y desarrollar habilidades de networking.',
                    steps: 'Crear perfil profesional en LinkedIn, desarrollar elevator pitch personal, participar en eventos de networking del TEC, crear portafolio b√°sico de proyectos.',
                    priority: 'medium',
                    categoria: 'perfil_profesional',
                    tips: 'Tip: Tu perfil profesional es tu carta de presentaci√≥n. Invierte tiempo en hacerlo aut√©ntico y atractivo.',
                    mentorCommitment: 'Te ayudar√© a crear un perfil profesional atractivo y te guiar√© en estrategias de networking efectivas.'
                },
                {
                    id: 'PRIM_OCC03',
                    title: 'Asesorarme con el √°rea de becas',
                    description: 'Buscar orientaci√≥n en el √°rea de becas para optimizar oportunidades de financiamiento y apoyo econ√≥mico.',
                    steps: 'Agendar cita con asesor de becas, revisar todas las opciones disponibles, cumplir con requisitos y fechas l√≠mite, mantener comunicaci√≥n regular con el √°rea.',
                    priority: 'high',
                    categoria: 'asesoria_becas',
                    tips: 'Tip: El √°rea de becas puede ayudarte a encontrar opciones que no conoc√≠as. Es mejor consultar temprano.',
                    mentorCommitment: 'Te ayudar√© a preparar tu consulta con el √°rea de becas y te guiar√© en c√≥mo aprovechar al m√°ximo la asesor√≠a.'
                },
                {
                    id: 'PRIM_OCC04',
                    title: 'Explorar oportunidades de experiencia pr√°ctica',
                    description: 'Identificar y participar en actividades que te den experiencia pr√°ctica en tu √°rea de inter√©s.',
                    steps: 'Buscar proyectos de investigaci√≥n, participar en competencias estudiantiles, explorar programas de verano, conectar con empresas para proyectos acad√©micos.',
                    priority: 'medium',
                    categoria: 'experiencia_practica',
                    tips: 'Tip: La experiencia pr√°ctica complementa perfectamente tu formaci√≥n acad√©mica. No esperes a graduarte para empezar.',
                    mentorCommitment: 'Te ayudar√© a identificar oportunidades de experiencia pr√°ctica y te guiar√© en c√≥mo aprovecharlas.'
                }
            ],
            'Emocional': [
                {
                    id: 'PRIM_EMO01',
                    title: 'Manejar el estr√©s y la ansiedad universitaria',
                    description: 'Desarrollar estrategias efectivas para gestionar el estr√©s acad√©mico y la ansiedad que puede generar la vida universitaria.',
                    steps: 'Identificar fuentes de estr√©s, practicar t√©cnicas de respiraci√≥n y relajaci√≥n, establecer rutinas de autocuidado, buscar apoyo en consejer√≠a estudiantil cuando sea necesario.',
                    priority: 'high',
                    categoria: 'gestion_estres',
                    tips: 'Tip: El estr√©s es normal en la universidad. La clave est√° en desarrollar herramientas para manejarlo de manera saludable.',
                    mentorCommitment: 'Te ayudar√© a identificar tus fuentes de estr√©s y te facilitar√© t√©cnicas de manejo que funcionen para ti.'
                },
                {
                    id: 'PRIM_EMO02',
                    title: 'Acudir a Consejer√≠a Emocional',
                    description: 'Buscar apoyo profesional en consejer√≠a estudiantil para hablar sobre tu bienestar emocional y recibir orientaci√≥n especializada.',
                    steps: 'Agendar cita en consejer√≠a estudiantil, preparar temas a discutir, asistir a sesiones regulares, aplicar recomendaciones del consejero.',
                    priority: 'high',
                    categoria: 'consejeria_emocional',
                    tips: 'Tip: La consejer√≠a es un recurso profesional disponible para todos los estudiantes. No hay nada de malo en buscar ayuda.',
                    mentorCommitment: 'Te ayudar√© a entender el proceso de consejer√≠a y te acompa√±ar√© en el proceso si lo necesitas.'
                },
                {
                    id: 'PRIM_EMO03',
                    title: 'Regular estr√©s con talleres de resiliencia',
                    description: 'Participar en talleres de consejer√≠a para adquirir herramientas de resiliencia y manejo del estr√©s.',
                    steps: 'Inscribirse en talleres de resiliencia, asistir regularmente, practicar t√©cnicas aprendidas, aplicar estrategias en situaciones reales.',
                    priority: 'medium',
                    categoria: 'talleres_resiliencia',
                    tips: 'Tip: Los talleres te dan herramientas pr√°cticas que puedes usar inmediatamente en tu vida universitaria.',
                    mentorCommitment: 'Te ayudar√© a identificar talleres relevantes y te motivar√© a aplicar las t√©cnicas aprendidas.'
                },
                {
                    id: 'PRIM_EMO04',
                    title: 'Desarrollar inteligencia emocional y autoconocimiento',
                    description: 'Mejorar la capacidad de reconocer, entender y gestionar las propias emociones y las de otros.',
                    steps: 'Practicar autoconciencia emocional diaria, desarrollar empat√≠a hacia compa√±eros, mejorar comunicaci√≥n asertiva, gestionar conflictos de manera constructiva.',
                    priority: 'medium',
                    categoria: 'inteligencia_emocional',
                    tips: 'Tip: La inteligencia emocional es tan importante como la acad√©mica. Te ayudar√° en todas las √°reas de tu vida.',
                    mentorCommitment: 'Te facilitar√© ejercicios de autoconocimiento y te ayudar√© a desarrollar habilidades emocionales clave.'
                }
            ],
            'Social': [
                {
                    id: 'PRIM_SOC01',
                    title: 'Unirse a un grupo estudiantil o club',
                    description: 'Participar activamente en una organizaci√≥n estudiantil que coincida con tus intereses y valores.',
                    steps: 'Explorar clubes y organizaciones disponibles, asistir a reuniones informativas, elegir 1-2 grupos que te interesen, participar activamente en actividades.',
                    priority: 'high',
                    categoria: 'participacion_estudiantil',
                    tips: 'Tip: Los grupos estudiantiles son excelentes para hacer amigos, desarrollar liderazgo y enriquecer tu experiencia universitaria.',
                    mentorCommitment: 'Te ayudar√© a encontrar grupos que coincidan con tus intereses y te guiar√© en c√≥mo participar efectivamente.'
                },
                {
                    id: 'PRIM_SOC02',
                    title: 'Asistir a eventos de integraci√≥n del campus',
                    description: 'Participar en actividades de integraci√≥n y eventos sociales para conocer gente nueva y adaptarte al campus.',
                    steps: 'Revisar calendario de eventos del campus, seleccionar 3 eventos de tu inter√©s, agendar fechas en tu calendario, conocer al menos 1 persona nueva en cada evento.',
                    priority: 'high',
                    categoria: 'integracion_campus',
                    tips: 'Tip: Los eventos de integraci√≥n son perfectos para conocer gente nueva y sentirte parte de la comunidad universitaria.',
                    mentorCommitment: 'Te ayudar√© a identificar eventos interesantes y te motivar√© a participar activamente.'
                },
                {
                    id: 'PRIM_SOC03',
                    title: 'Mantener conexi√≥n con familia y amigos de casa',
                    description: 'Equilibrar nuevas relaciones universitarias con el mantenimiento de v√≠nculos importantes de casa.',
                    steps: 'Establecer horarios regulares para llamar a familia, planificar visitas a casa, mantener contacto con amigos de preparatoria, crear nuevos rituales de conexi√≥n.',
                    priority: 'medium',
                    categoria: 'mantenimiento_relaciones',
                    tips: 'Tip: Es importante mantener tus ra√≠ces mientras construyes nuevas relaciones. El equilibrio es clave.',
                    mentorCommitment: 'Te ayudar√© a encontrar el equilibrio entre nuevas y viejas relaciones, y te apoyar√© en momentos de nostalgia.'
                },
                {
                    id: 'PRIM_SOC04',
                    title: 'Conocer compa√±eros y profesores del grupo',
                    description: 'Establecer relaciones iniciales con compa√±eros de tu grupo y profesores durante las primeras semanas.',
                    steps: 'Presentarte a compa√±eros en las primeras clases, intercambiar contactos con 3 compa√±eros, saludar y presentarte a tus profesores, crear grupo de WhatsApp con compa√±eros del grupo.',
                    priority: 'medium',
                    categoria: 'relaciones_grupo',
                    tips: 'Tip: Las primeras semanas son clave para establecer conexiones. No esperes a que otros tomen la iniciativa.',
                    mentorCommitment: 'Te ayudar√© a desarrollar estrategias para iniciar conversaciones y te motivar√© a ser proactivo en conocer a tu grupo.'
                }
            ],
            'F√≠sica': [
                {
                    id: 'PRIM_FIS01',
                    title: 'Establecer rutina de ejercicio y actividad f√≠sica',
                    description: 'Crear h√°bitos de actividad f√≠sica que promuevan la salud, reduzcan el estr√©s y mejoren el rendimiento acad√©mico.',
                    steps: 'Encontrar actividad f√≠sica que disfrutes (gimnasio, deportes, yoga, caminar), establecer horarios fijos 3-4 veces por semana, comenzar gradualmente, monitorear progreso y energ√≠a.',
                    priority: 'high',
                    categoria: 'ejercicio_fisico',
                    tips: 'Tip: El ejercicio no solo es bueno para tu cuerpo, tambi√©n mejora tu concentraci√≥n, reduce estr√©s y te da m√°s energ√≠a para estudiar.',
                    mentorCommitment: 'Te facilitar√© recursos para encontrar actividades f√≠sicas que se adapten a tu horario y te ayudar√© a desarrollar estrategias para mantener la consistencia.'
                },
                {
                    id: 'PRIM_FIS02',
                    title: 'Acudir a clase Life y probar deporte nuevo',
                    description: 'Participar en clases Life de acceso abierto y explorar nuevos deportes para diversificar tu actividad f√≠sica.',
                    steps: 'Revisar horarios de clases Life disponibles, inscribirse en una clase que te interese, probar al menos 2 deportes nuevos, evaluar cu√°l disfrutas m√°s.',
                    priority: 'high',
                    categoria: 'clases_life_deportes',
                    tips: 'Tip: Las clases Life son una excelente oportunidad para probar actividades nuevas sin compromiso a largo plazo.',
                    mentorCommitment: 'Te ayudar√© a identificar clases Life interesantes y te motivar√© a probar nuevas actividades f√≠sicas.'
                },
                {
                    id: 'PRIM_FIS03',
                    title: 'Optimizar h√°bitos de sue√±o y descanso',
                    description: 'Mejorar la calidad y cantidad de sue√±o para optimizar el rendimiento acad√©mico y la salud general.',
                    steps: 'Establecer horario de sue√±o consistente (7-8 horas), crear rutina pre-sue√±o relajante, optimizar ambiente de dormitorio, limitar pantallas 1 hora antes de dormir.',
                    priority: 'medium',
                    categoria: 'descanso_sue√±o',
                    tips: 'Tip: El sue√±o es fundamental para la memoria y el aprendizaje. Un buen descanso mejora significativamente tu rendimiento acad√©mico.',
                    mentorCommitment: 'Te facilitar√© recursos para crear una rutina de sue√±o saludable y te ayudar√© a entender la importancia del descanso para tu √©xito acad√©mico.'
                },
                {
                    id: 'PRIM_FIS04',
                    title: 'Mantener alimentaci√≥n balanceada y saludable',
                    description: 'Desarrollar h√°bitos alimenticios saludables que apoyen el rendimiento acad√©mico y la salud f√≠sica.',
                    steps: 'Planificar comidas semanalmente, incluir frutas y verduras en cada comida, mantenerse hidratado (8 vasos de agua), evitar excesos de cafe√≠na y comida chatarra.',
                    priority: 'medium',
                    categoria: 'alimentacion_saludable',
                    tips: 'Tip: Una buena alimentaci√≥n es combustible para tu cerebro. Comer bien te ayuda a concentrarte mejor y tener m√°s energ√≠a.',
                    mentorCommitment: 'Te facilitar√© recursos de alimentaci√≥n saludable para estudiantes y te ayudar√© a desarrollar habilidades para planificar comidas nutritivas.'
                }
            ],
            'Espiritual': [
                {
                    id: 'PRIM_ESP01',
                    title: 'Reflexionar sobre valores y prop√≥sito de carrera',
                    description: 'Explorar valores personales y reflexionar sobre el prop√≥sito de estudiar tu carrera durante 10 minutos semanales.',
                    steps: 'Establecer horario fijo semanal para reflexi√≥n (ej. domingos por la noche), crear espacio tranquilo para reflexionar, escribir en diario mis motivaciones para estudiar mi carrera, revisar y ajustar mis reflexiones cada semana.',
                    priority: 'high',
                    categoria: 'reflexion_proposito',
                    tips: 'Tip: Conocer tu prop√≥sito te ayuda a tomar mejores decisiones y mantener motivaci√≥n durante los desaf√≠os universitarios.',
                    mentorCommitment: 'Te facilitar√© ejercicios de reflexi√≥n y te acompa√±ar√© en conversaciones profundas para explorar tus valores y prop√≥sito.'
                },
                {
                    id: 'PRIM_ESP02',
                    title: 'Acudir al espacio Punto Blanco del campus',
                    description: 'Participar en actividades de reflexi√≥n y meditaci√≥n en el espacio Punto Blanco del campus.',
                    steps: 'Ubicar Punto Blanco en tu campus, revisar horario de actividades disponibles, seleccionar 2 actividades que te interesen (meditaci√≥n, reflexi√≥n, etc.), asistir y participar activamente, reflexionar sobre la experiencia despu√©s de cada actividad.',
                    priority: 'high',
                    categoria: 'punto_blanco',
                    tips: 'Tip: Punto Blanco es un espacio especial para la reflexi√≥n y el crecimiento espiritual. Es un recurso √∫nico del TEC.',
                    mentorCommitment: 'Te ayudar√© a ubicar Punto Blanco y te motivar√© a participar en sus actividades de crecimiento personal.'
                },
                {
                    id: 'PRIM_ESP03',
                    title: 'Desarrollar pr√°ctica de meditaci√≥n y mindfulness',
                    description: 'Cultivar una pr√°ctica regular de meditaci√≥n o mindfulness para mejorar el bienestar mental y la concentraci√≥n.',
                    steps: 'Comenzar con 5-10 minutos diarios de meditaci√≥n, usar apps como Headspace o Calm, practicar respiraci√≥n consciente, crear espacio tranquilo para la pr√°ctica.',
                    priority: 'medium',
                    categoria: 'meditacion_mindfulness',
                    tips: 'Tip: La meditaci√≥n no es solo relajaci√≥n, es entrenamiento mental que mejora tu concentraci√≥n y reduce el estr√©s acad√©mico.',
                    mentorCommitment: 'Te facilitar√© recursos y t√©cnicas de meditaci√≥n para principiantes y te ayudar√© a desarrollar una pr√°ctica sostenible.'
                },
                {
                    id: 'PRIM_ESP04',
                    title: 'Cultivar gratitud y perspectiva positiva',
                    description: 'Desarrollar una actitud de agradecimiento que mejore el bienestar general y la resiliencia.',
                    steps: 'Mantener diario de gratitud, expresar agradecimiento a otros, practicar mindfulness, reflexionar sobre bendiciones diarias, celebrar peque√±os logros.',
                    priority: 'medium',
                    categoria: 'gratitud_perspectiva',
                    tips: 'Tip: La gratitud cambia tu perspectiva y te ayuda a ver oportunidades donde otros ven problemas.',
                    mentorCommitment: 'Te recordar√© practicar gratitud y te ayudar√© a desarrollar una perspectiva m√°s positiva ante los desaf√≠os.'
                }
            ],
            'Financiera': [
                {
                    id: 'PRIM_FIN01',
                    title: 'Crear presupuesto universitario y gestionar gastos',
                    description: 'Establecer un plan financiero que cubra gastos acad√©micos, personales y de vida universitaria.',
                    steps: 'Identificar ingresos (becas, familia, trabajo), categorizar gastos por prioridad (acad√©micos, vivienda, alimentaci√≥n, transporte), establecer l√≠mites de gasto, revisar y ajustar mensualmente.',
                    priority: 'high',
                    categoria: 'presupuesto_gastos',
                    tips: 'Tip: Un presupuesto universitario te da control sobre tu dinero y reduce el estr√©s financiero. Es tu herramienta de libertad financiera.',
                    mentorCommitment: 'Te ayudar√© a crear tu primer presupuesto universitario y te ense√±ar√© a mantenerlo actualizado.'
                },
                {
                    id: 'PRIM_FIN02',
                    title: 'Evaluar menor carga acad√©mica y plan de regularizaci√≥n',
                    description: 'Considerar inscribir menor carga acad√©mica para disminuir costos y crear un plan de regularizaci√≥n con tu Director/a de Entrada y Mentor/a.',
                    steps: 'Evaluar situaci√≥n acad√©mica actual, consultar con Director/a de Entrada sobre opciones, crear plan de regularizaci√≥n, ajustar carga acad√©mica si es necesario.',
                    priority: 'high',
                    categoria: 'carga_academica_regularizacion',
                    tips: 'Tip: A veces es mejor tomar menos materias y aprobarlas bien que sobrecargarse y tener problemas acad√©micos.',
                    mentorCommitment: 'Te ayudar√© a evaluar tu situaci√≥n acad√©mica y te acompa√±ar√© en el proceso de regularizaci√≥n si es necesario.'
                },
                {
                    id: 'PRIM_FIN03',
                    title: 'Disminuir gastos hormiga y optimizar gastos',
                    description: 'Identificar y reducir gastos peque√±os que se acumulan y afectan el presupuesto universitario.',
                    steps: 'Llevar registro de gastos diarios por una semana, identificar gastos hormiga (caf√©, snacks, apps), establecer l√≠mites para estos gastos, buscar alternativas m√°s econ√≥micas.',
                    priority: 'medium',
                    categoria: 'gastos_hormiga',
                    tips: 'Tip: Los gastos hormiga pueden sumar mucho al mes. Un caf√© diario puede costarte m√°s de $500 pesos mensuales.',
                    mentorCommitment: 'Te ayudar√© a identificar tus gastos hormiga y te facilitar√© estrategias para reducirlos sin sacrificar tu bienestar.'
                },
                {
                    id: 'PRIM_FIN04',
                    title: 'Aprender servicios financieros del campus',
                    description: 'Conocer y utilizar los servicios financieros b√°sicos disponibles en el campus como cafeter√≠a, fotocopias y transporte.',
                    steps: 'Investigar servicios disponibles en el campus, probar sistema de pagos de cafeter√≠a, conocer opciones de transporte estudiantil, crear lista de servicios y costos.',
                    priority: 'medium',
                    categoria: 'servicios_campus',
                    tips: 'Tip: Conocer los servicios del campus te ayuda a optimizar tu presupuesto y aprovechar mejor los recursos disponibles.',
                    mentorCommitment: 'Te ayudar√© a identificar todos los servicios financieros del campus y te guiar√© en c√≥mo utilizarlos eficientemente.'
                }
            ]
        };

        let currentStep = 1;
        let selectedDimensions = [];
        let studentData = {};

        // Inicializar la aplicaci√≥n
        function init() {
            renderDimensions();
            updateProgress();
        }

        // Renderizar las dimensiones disponibles
        function renderDimensions() {
            const grid = document.getElementById('dimensionGrid');
            grid.innerHTML = '';

            Object.entries(DIMENSIONS).forEach(([key, dimension]) => {
                const card = document.createElement('div');
                card.className = 'dimension-card';
                card.onclick = () => selectDimension(key, card);
                
                card.innerHTML = `
                    <div class="dimension-emoji">${dimension.emoji}</div>
                    <div class="dimension-title">${key}</div>
                    <div class="dimension-description">${dimension.description}</div>
                `;
                
                grid.appendChild(card);
            });
        }

        // Seleccionar una dimensi√≥n
        function selectDimension(dimension, card) {
            if (selectedDimensions.includes(dimension)) {
                // Deseleccionar
                selectedDimensions = selectedDimensions.filter(d => d !== dimension);
                card.classList.remove('selected', 'priority-1', 'priority-2', 'priority-3');
                
                // Remover badge de prioridad
                const existingBadge = card.querySelector('.priority-badge');
                if (existingBadge) {
                    existingBadge.remove();
                }
                
                // Reorganizar prioridades de las dimensiones restantes
                reorganizePriorities();
            } else if (selectedDimensions.length < 3) {
                // Seleccionar
                selectedDimensions.push(dimension);
                const priority = selectedDimensions.length;
                card.classList.add('selected', `priority-${priority}`);
                
                // Remover badge anterior si existe
                const existingBadge = card.querySelector('.priority-badge');
                if (existingBadge) {
                    existingBadge.remove();
                }
                
                // Agregar badge de prioridad
                const badge = document.createElement('div');
                badge.className = 'priority-badge';
                badge.textContent = `Prioridad ${priority}`;
                card.appendChild(badge);
            }
            
            // Actualizar bot√≥n de continuar
            const nextBtn = document.getElementById('nextBtn2');
            nextBtn.disabled = selectedDimensions.length !== 3;
        }
        
        // Reorganizar prioridades cuando se deselecciona una dimensi√≥n
        function reorganizePriorities() {
            const cards = document.querySelectorAll('.dimension-card.selected');
            cards.forEach((card, index) => {
                // Remover clases de prioridad anteriores
                card.classList.remove('priority-1', 'priority-2', 'priority-3');
                card.classList.add(`priority-${index + 1}`);
                
                // Actualizar badge
                const badge = card.querySelector('.priority-badge');
                if (badge) {
                    badge.textContent = `Prioridad ${index + 1}`;
                }
            });
        }

        // Navegar al siguiente paso
        function nextStep() {
            if (currentStep === 1) {
                // Validar informaci√≥n del estudiante
                const matricula = document.getElementById('matricula').value.trim();
                const nombre = document.getElementById('nombre').value.trim();
                
                if (!matricula || !nombre) {
                    alert('Por favor completa todos los campos obligatorios');
                    return;
                }
                
                studentData = { matricula, nombre };
            } else if (currentStep === 2) {
                if (selectedDimensions.length !== 3) {
                    alert('Por favor selecciona exactamente 3 dimensiones');
                    return;
                }
                
                // Generar recomendaciones
                generateRecommendations();
            }
            
            // Cambiar al siguiente paso
            document.getElementById(`step${currentStep}`).classList.remove('active');
            currentStep++;
            document.getElementById(`step${currentStep}`).classList.add('active');
            updateProgress();
        }

        // Navegar al paso anterior
        function prevStep() {
            document.getElementById(`step${currentStep}`).classList.remove('active');
            currentStep--;
            document.getElementById(`step${currentStep}`).classList.add('active');
            updateProgress();
        }

        // Actualizar barra de progreso
        function updateProgress() {
            const progress = (currentStep / 3) * 100;
            document.getElementById('progressFill').style.width = `${progress}%`;
        }

        // Generar recomendaciones
        function generateRecommendations() {
            const loading = document.getElementById('loading');
            const recommendations = document.getElementById('recommendations');
            const summary = document.getElementById('summary');
            
            // Mostrar loading
            loading.style.display = 'block';
            recommendations.style.display = 'none';
            
            // Generar resumen
            generateSummary(summary);
            
            // Simular tiempo de procesamiento
            setTimeout(() => {
                generateRecommendationCards(recommendations);
                loading.style.display = 'none';
                recommendations.style.display = 'grid';
            }, 2000);
        }

        // Generar resumen
        function generateSummary(summaryElement) {
            summaryElement.innerHTML = `
                <h3>üìã Resumen de tu Selecci√≥n</h3>
                <div class="summary-item">
                    <span><strong>Estudiante:</strong></span>
                    <span>${studentData.nombre} (${studentData.matricula})</span>
                </div>
                <div class="summary-item">
                    <span><strong>Dimensi√≥n 1 (Prioritaria):</strong></span>
                    <span>${selectedDimensions[0]} ${DIMENSIONS[selectedDimensions[0]].emoji}</span>
                </div>
                <div class="summary-item">
                    <span><strong>Dimensi√≥n 2:</strong></span>
                    <span>${selectedDimensions[1]} ${DIMENSIONS[selectedDimensions[1]].emoji}</span>
                </div>
                <div class="summary-item">
                    <span><strong>Dimensi√≥n 3:</strong></span>
                    <span>${selectedDimensions[2]} ${DIMENSIONS[selectedDimensions[2]].emoji}</span>
                </div>
            `;
        }

        // Generar tarjetas de recomendaciones
        function generateRecommendationCards(recommendationsElement) {
            recommendationsElement.innerHTML = '';
            
            selectedDimensions.forEach((dimension, index) => {
                const goals = GOALS_DATABASE[dimension] || [];
                const priorityGoal = goals[0]; // Meta de mayor prioridad
                
                if (priorityGoal) {
                    const card = document.createElement('div');
                    card.className = 'recommendation-card';
                    
                    const badgeClass = index === 0 ? 'badge-priority' : 
                                     index === 1 ? 'badge-complementary' : 'badge-longitudinal';
                    const badgeText = index === 0 ? 'Prioritaria' : 
                                    index === 1 ? 'Complementaria' : 'Longitudinal';
                    
                    card.innerHTML = `
                        <div class="recommendation-header">
                            <div class="recommendation-badge ${badgeClass}">${badgeText}</div>
                            <div class="recommendation-badge" style="background: #6c757d; color: white;">${dimension}</div>
                        </div>
                        <div class="recommendation-title">${priorityGoal.title}</div>
                        <div class="recommendation-description">${priorityGoal.description}</div>
                        <div class="recommendation-actions">
                            <button class="btn btn-small" onclick="selectGoal('${priorityGoal.id}')">Seleccionar Meta</button>
                            <button class="btn btn-small btn-outline" onclick="viewAlternatives('${dimension}')">Ver Alternativas</button>
                        </div>
                    `;
                    
                    recommendationsElement.appendChild(card);
                }
            });
        }

        // Seleccionar una meta
        function selectGoal(goalId) {
            alert(`Meta ${goalId} seleccionada. Esta funcionalidad se integrar√° con el sistema principal.`);
        }

        // Ver alternativas
        function viewAlternatives(dimension) {
            const goals = GOALS_DATABASE[dimension] || [];
            const alternatives = goals; // Mostrar TODAS las metas disponibles
            
            // Crear modal para mostrar alternativas
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0,0,0,0.5);
                display: flex;
                justify-content: center;
                align-items: center;
                z-index: 1000;
            `;
            
            const modalContent = document.createElement('div');
            modalContent.style.cssText = `
                background: white;
                border-radius: 15px;
                padding: 30px;
                max-width: 800px;
                max-height: 90vh;
                overflow-y: auto;
                margin: 20px;
                box-shadow: 0 20px 40px rgba(0,0,0,0.3);
            `;
            
            let alternativesHTML = `
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <h2 style="color: #333; margin: 0;">Todas las Metas para ${dimension}</h2>
                    <button onclick="this.closest('.modal').remove()" style="background: #f44336; color: white; border: none; border-radius: 50%; width: 30px; height: 30px; cursor: pointer; font-size: 18px;">√ó</button>
                </div>
                <p style="color: #666; margin-bottom: 20px;">Elige una de estas metas para reemplazar la recomendaci√≥n actual:</p>
            `;
            
            alternatives.forEach((goal, index) => {
                alternativesHTML += `
                    <div style="border: 2px solid #e1e5e9; border-radius: 10px; padding: 20px; margin-bottom: 15px; cursor: pointer; transition: all 0.3s ease; background: white;" 
                         onmouseover="this.style.borderColor='#4285f4'; this.style.transform='translateY(-2px)'"
                         onmouseout="this.style.borderColor='#e1e5e9'; this.style.transform='translateY(0)'"
                         onclick="selectAlternative('${goal.id}', '${dimension}', ${index})">
                        <h3 style="color: #333; margin: 0 0 10px 0; font-size: 1.1em;">${goal.title}</h3>
                        <p style="color: #666; margin: 0 0 15px 0; line-height: 1.4;">${goal.description}</p>
                        <div style="background: #f8f9fa; padding: 10px; border-radius: 5px; font-size: 0.9em;">
                            <strong>Pasos de acci√≥n:</strong><br>
                            ${goal.steps}
                        </div>
                        <button style="background: #4285f4; color: white; border: none; padding: 8px 16px; border-radius: 5px; margin-top: 10px; cursor: pointer;">
                            Seleccionar esta meta
                        </button>
                    </div>
                `;
            });
            
            // Agregar opci√≥n de meta personalizada
            alternativesHTML += `
                <div style="border: 2px dashed #4285f4; border-radius: 10px; padding: 20px; margin-bottom: 15px; background: #f8f9ff; cursor: pointer; transition: all 0.3s ease;" 
                     onmouseover="this.style.borderColor='#1a73e8'; this.style.transform='translateY(-2px)'"
                     onmouseout="this.style.borderColor='#4285f4'; this.style.transform='translateY(0)'"
                     onclick="showCustomGoalForm('${dimension}')">
                    <h3 style="color: #4285f4; margin: 0 0 10px 0; font-size: 1.1em;">‚ú® Quiero crear mi propia meta</h3>
                    <p style="color: #666; margin: 0 0 15px 0; line-height: 1.4;">¬øTienes una meta espec√≠fica en mente que no est√° en la lista? ¬°Cr√©ala siguiendo los elementos SMARTER!</p>
                    <div style="background: #e3f2fd; padding: 10px; border-radius: 5px; font-size: 0.9em;">
                        <strong>Elementos SMARTER:</strong><br>
                        <strong>S</strong>pec√≠fica, <strong>M</strong>edible, <strong>A</strong>lcanzable, <strong>R</strong>elevante, <strong>T</strong>iempo definido, <strong>E</strong>valuable, <strong>R</strong>evisable
                    </div>
                    <button style="background: #4285f4; color: white; border: none; padding: 8px 16px; border-radius: 5px; margin-top: 10px; cursor: pointer;">
                        Crear mi meta personalizada
                    </button>
                </div>
            `;
            
            modalContent.innerHTML = alternativesHTML;
            modal.appendChild(modalContent);
            modal.className = 'modal';
            document.body.appendChild(modal);
            
            // Cerrar modal al hacer clic fuera
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    modal.remove();
                }
            });
        }
        
        // Seleccionar alternativa
        function selectAlternative(goalId, dimension, goalIndex) {
            // Encontrar la meta seleccionada
            const goals = GOALS_DATABASE[dimension] || [];
            const selectedGoal = goals[goalIndex];
            
            if (!selectedGoal) {
                alert('Error: No se pudo encontrar la meta seleccionada');
                return;
            }
            
            // Actualizar la recomendaci√≥n en la interfaz
            updateRecommendationCard(dimension, selectedGoal);
            
            // Cerrar modal
            const modal = document.querySelector('.modal');
            if (modal) {
                modal.remove();
            }
            
            // Mostrar confirmaci√≥n
            showNotification(`Meta actualizada: "${selectedGoal.title}" para ${dimension}`, 'success');
        }
        
        // Mostrar formulario para meta personalizada
        function showCustomGoalForm(dimension) {
            // Cerrar modal actual
            const modal = document.querySelector('.modal');
            if (modal) {
                modal.remove();
            }
            
            // Crear modal para formulario de meta personalizada
            const customModal = document.createElement('div');
            customModal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0,0,0,0.5);
                display: flex;
                justify-content: center;
                align-items: center;
                z-index: 1000;
            `;
            
            const modalContent = document.createElement('div');
            modalContent.style.cssText = `
                background: white;
                border-radius: 15px;
                padding: 30px;
                max-width: 600px;
                max-height: 90vh;
                overflow-y: auto;
                margin: 20px;
                box-shadow: 0 20px 40px rgba(0,0,0,0.3);
            `;
            
            modalContent.innerHTML = `
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <h2 style="color: #333; margin: 0;">Crear Meta Personalizada - ${dimension}</h2>
                    <button onclick="this.closest('.modal').remove()" style="background: #f44336; color: white; border: none; border-radius: 50%; width: 30px; height: 30px; cursor: pointer; font-size: 18px;">√ó</button>
                </div>
                
                <div style="background: #e3f2fd; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                    <h4 style="color: #1976d2; margin: 0 0 10px 0;">Crea tu meta personalizada:</h4>
                    <p style="margin: 0; color: #666; font-size: 0.9em;">
                        Te guiaremos paso a paso para crear una meta clara y alcanzable. Solo necesitamos algunos detalles b√°sicos.
                    </p>
                </div>
                
                <form id="customGoalForm">
                    <div style="margin-bottom: 20px;">
                        <label style="display: block; margin-bottom: 5px; font-weight: bold; color: #333;">T√≠tulo de tu meta:</label>
                        <input type="text" id="customGoalTitle" placeholder="Ej: Aprender a tocar guitarra" style="width: 100%; padding: 10px; border: 2px solid #e1e5e9; border-radius: 5px; font-size: 16px;" required>
                    </div>
                    
                    <div style="margin-bottom: 20px;">
                        <label style="display: block; margin-bottom: 5px; font-weight: bold; color: #333;">¬øQu√© quieres lograr exactamente?</label>
                        <textarea id="customGoalDescription" placeholder="Describe tu meta de manera espec√≠fica..." style="width: 100%; padding: 10px; border: 2px solid #e1e5e9; border-radius: 5px; font-size: 16px; height: 60px; resize: vertical;" required></textarea>
                    </div>
                    
                    <div style="margin-bottom: 20px;">
                        <label style="display: block; margin-bottom: 5px; font-weight: bold; color: #333;">¬øC√≥mo lo lograr√°s? (Pasos principales):</label>
                        <textarea id="customGoalSteps" placeholder="Lista 2-3 pasos principales que seguir√°s..." style="width: 100%; padding: 10px; border: 2px solid #e1e5e9; border-radius: 5px; font-size: 16px; height: 80px; resize: vertical;" required></textarea>
                    </div>
                    
                    <div style="margin-bottom: 20px;">
                        <label style="display: block; margin-bottom: 5px; font-weight: bold; color: #333;">¬øPara cu√°ndo quieres lograrlo?</label>
                        <select id="customGoalDeadline" style="width: 100%; padding: 10px; border: 2px solid #e1e5e9; border-radius: 5px; font-size: 16px;" required>
                            <option value="">Selecciona un plazo</option>
                            <option value="1 mes">En 1 mes</option>
                            <option value="2 meses">En 2 meses</option>
                            <option value="3 meses">En 3 meses</option>
                            <option value="6 meses">En 6 meses</option>
                            <option value="1 a√±o">En 1 a√±o</option>
                        </select>
                    </div>
                    
                    <div style="margin-bottom: 20px;">
                        <label style="display: block; margin-bottom: 5px; font-weight: bold; color: #333;">¬øC√≥mo sabr√°s que lo lograste?</label>
                        <textarea id="customGoalSuccess" placeholder="Describe c√≥mo medir√°s tu √©xito..." style="width: 100%; padding: 10px; border: 2px solid #e1e5e9; border-radius: 5px; font-size: 16px; height: 60px; resize: vertical;" required></textarea>
                    </div>
                    
                    <div style="display: flex; gap: 10px; justify-content: flex-end;">
                        <button type="button" onclick="this.closest('.modal').remove()" style="background: #6c757d; color: white; border: none; padding: 12px 24px; border-radius: 5px; cursor: pointer; font-size: 16px;">Cancelar</button>
                        <button type="submit" style="background: #4285f4; color: white; border: none; padding: 12px 24px; border-radius: 5px; cursor: pointer; font-size: 16px;">Crear Meta</button>
                    </div>
                </form>
            `;
            
            customModal.appendChild(modalContent);
            customModal.className = 'modal';
            document.body.appendChild(customModal);
            
            // Manejar env√≠o del formulario
            const form = modalContent.querySelector('#customGoalForm');
            form.addEventListener('submit', (e) => {
                e.preventDefault();
                createCustomGoal(dimension, customModal);
            });
            
            // Cerrar modal al hacer clic fuera
            customModal.addEventListener('click', (e) => {
                if (e.target === customModal) {
                    customModal.remove();
                }
            });
        }
        
        // Crear meta personalizada
        function createCustomGoal(dimension, modal) {
            const title = document.getElementById('customGoalTitle').value;
            const description = document.getElementById('customGoalDescription').value;
            const steps = document.getElementById('customGoalSteps').value;
            const deadline = document.getElementById('customGoalDeadline').value;
            const success = document.getElementById('customGoalSuccess').value;
            
            // Crear objeto de meta personalizada simplificada
            const customGoal = {
                id: `CUSTOM_${dimension.toUpperCase()}_${Date.now()}`,
                title: title,
                description: description,
                steps: steps,
                priority: 'custom',
                categoria: 'meta_personalizada',
                tips: `Tip: Esta es tu meta personalizada. Recuerda revisar tu progreso regularmente y ajustar si es necesario.`,
                mentorCommitment: `Te ayudar√© a mantenerte motivado con esta meta personalizada y te facilitar√© recursos espec√≠ficos que identifiques necesitar.`,
                deadline: deadline,
                successIndicators: success,
                isCustom: true
            };
            
            // Actualizar la tarjeta de recomendaci√≥n
            updateRecommendationCard(dimension, customGoal);
            
            // Cerrar modal
            modal.remove();
            
            // Mostrar notificaci√≥n
            showNotification(`Meta personalizada "${title}" creada para ${dimension}`, 'success');
        }
        
        // Actualizar tarjeta de recomendaci√≥n
        function updateRecommendationCard(dimension, newGoal) {
            const recommendationsContainer = document.getElementById('recommendations');
            
            if (!recommendationsContainer) {
                console.log('Contenedor de recomendaciones no encontrado');
                return;
            }
            
            const cards = recommendationsContainer.querySelectorAll('.recommendation-card');
            
            // Encontrar la tarjeta correspondiente a la dimensi√≥n
            cards.forEach(card => {
                const dimensionBadge = card.querySelector('.recommendation-badge:last-child');
                if (dimensionBadge && dimensionBadge.textContent === dimension) {
                    // Actualizar el contenido de la tarjeta
                    const titleElement = card.querySelector('.recommendation-title');
                    const descriptionElement = card.querySelector('.recommendation-description');
                    
                    if (titleElement) {
                        titleElement.textContent = newGoal.title;
                        console.log(`T√≠tulo actualizado: ${newGoal.title}`);
                    }
                    if (descriptionElement) {
                        descriptionElement.textContent = newGoal.description;
                        console.log(`Descripci√≥n actualizada: ${newGoal.description}`);
                    }
                    
                    // Actualizar el bot√≥n de alternativas para que apunte a la nueva meta
                    const alternativesBtn = card.querySelector('button[onclick*="viewAlternatives"]');
                    if (alternativesBtn) {
                        alternativesBtn.onclick = () => viewAlternatives(dimension);
                    }
                    
                    console.log(`Tarjeta actualizada para ${dimension}`);
                }
            });
        }
        
        // Mostrar notificaci√≥n
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: ${type === 'success' ? '#4caf50' : type === 'error' ? '#f44336' : '#2196f3'};
                color: white;
                padding: 15px 20px;
                border-radius: 10px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.3);
                z-index: 1001;
                font-weight: 600;
                max-width: 300px;
                animation: slideIn 0.3s ease;
            `;
            
            notification.textContent = message;
            document.body.appendChild(notification);
            
            // Remover despu√©s de 3 segundos
            setTimeout(() => {
                notification.style.animation = 'slideOut 0.3s ease';
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 300);
            }, 3000);
        }

        // Guardar resultados
        function saveResults() {
            const results = {
                student: studentData,
                dimensions: selectedDimensions,
                timestamp: new Date().toISOString(),
                recommendations: generateRecommendationsData()
            };
            
            // Mostrar loading
            const loadingDiv = document.createElement('div');
            loadingDiv.innerHTML = `
                <div class="loading">
                    <div class="spinner"></div>
                    <p>Guardando resultados y enviando correo...</p>
                </div>
            `;
            document.querySelector('.content').appendChild(loadingDiv);
            
            // Enviar a Apps Script
            try {
                // Llamar a la funci√≥n de Apps Script
                google.script.run
                    .withSuccessHandler(onSaveSuccess)
                    .withFailureHandler(onSaveError)
                    .processDimensionSelection(results);
            } catch (error) {
                console.error('Error al conectar con Apps Script:', error);
                // Fallback: mostrar resumen local
                setTimeout(() => {
                    loadingDiv.remove();
                    showLocalSummary(results);
                }, 2000);
            }
        }
        
        // Generar datos de recomendaciones
        function generateRecommendationsData() {
            const recommendations = [];
            selectedDimensions.forEach((dimension, index) => {
                // Buscar la meta actualmente mostrada en la interfaz
                const currentGoal = getCurrentGoalForDimension(dimension);
                if (currentGoal) {
                    recommendations.push({
                        dimension: dimension,
                        priority: index + 1,
                        goal: currentGoal
                    });
                }
            });
            return recommendations;
        }
        
        // Obtener la meta actual para una dimensi√≥n espec√≠fica
        function getCurrentGoalForDimension(dimension) {
            const recommendationsContainer = document.getElementById('recommendations');
            if (!recommendationsContainer) {
                // Si no existe el contenedor, usar la meta predeterminada
                const goals = GOALS_DATABASE[dimension] || [];
                return goals[0];
            }
            
            const cards = recommendationsContainer.querySelectorAll('.recommendation-card');
            for (let card of cards) {
                const dimensionBadge = card.querySelector('.recommendation-badge:last-child');
                if (dimensionBadge && dimensionBadge.textContent === dimension) {
                    const titleElement = card.querySelector('.recommendation-title');
                    const descriptionElement = card.querySelector('.recommendation-description');
                    
                    if (titleElement && descriptionElement) {
                        // Buscar la meta que coincida con el t√≠tulo actual
                        const goals = GOALS_DATABASE[dimension] || [];
                        const currentGoal = goals.find(goal => goal.title === titleElement.textContent);
                        return currentGoal || goals[0]; // Fallback a la primera meta
                    }
                }
            }
            
            // Fallback: usar la primera meta de la dimensi√≥n
            const goals = GOALS_DATABASE[dimension] || [];
            return goals[0];
        }
        
        // Callback de √©xito al guardar
        function onSaveSuccess(response) {
            // Remover loading inmediatamente
            const loadingDiv = document.querySelector('.loading');
            if (loadingDiv) {
                loadingDiv.parentNode.removeChild(loadingDiv);
            }
            
            // Tambi√©n remover cualquier loading que est√© en el content
            const contentLoading = document.querySelector('.content .loading');
            if (contentLoading) {
                contentLoading.parentNode.removeChild(contentLoading);
            }
            
            // Mostrar notificaci√≥n de √©xito
            showNotification('Resultados guardados y correo enviado exitosamente', 'success');
            
            // Mostrar mensaje de √©xito inmediatamente
            showSuccessMessage();
        }
        
        // Callback de error al guardar
        function onSaveError(error) {
            console.error('Error al guardar:', error);
            
            // Remover loading inmediatamente
            const loadingDiv = document.querySelector('.loading');
            if (loadingDiv) {
                loadingDiv.parentNode.removeChild(loadingDiv);
            }
            
            // Tambi√©n remover cualquier loading que est√© en el content
            const contentLoading = document.querySelector('.content .loading');
            if (contentLoading) {
                contentLoading.parentNode.removeChild(contentLoading);
            }
            
            // Mostrar notificaci√≥n de error
            showNotification('Error al conectar con el servidor. Mostrando resumen local.', 'error');
            
            // Mostrar resumen local inmediatamente
            showLocalSummary({
                student: studentData,
                dimensions: selectedDimensions,
                recommendations: generateRecommendationsData()
            });
        }
        
        // Mostrar resumen local cuando no se puede conectar con Apps Script
        function showLocalSummary(results) {
            const summaryDiv = document.createElement('div');
            summaryDiv.innerHTML = `
                <div class="success-message">
                    <div class="success-icon">‚ö†</div>
                    <h2>Resultados generados localmente</h2>
                    <p>No se pudo conectar con el servidor, pero aqu√≠ tienes tu resumen:</p>
                    
                    <div class="next-steps">
                        <h3>Tus 3 Metas Personalizadas:</h3>
                        ${results.recommendations.map((rec, index) => `
                            <div style="background: white; border: 2px solid #e1e5e9; border-radius: 10px; padding: 20px; margin: 15px 0;">
                                <h4 style="color: #333; margin: 0 0 10px 0;">${rec.goal.title}</h4>
                                <p style="color: #666; margin: 0 0 15px 0;">${rec.goal.description}</p>
                                <div style="background: #f8f9fa; padding: 10px; border-radius: 5px; font-size: 0.9em;">
                                    <strong>Pasos de acci√≥n:</strong><br>
                                    ${rec.goal.steps}
                                </div>
                            </div>
                        `).join('')}
                    </div>
                    
                    <div class="email-help">
                        <h4>Instrucciones para guardar en Mi Tec:</h4>
                        <ol style="text-align: left; margin: 20px 0;">
                            <li>Accede a <strong>Mi Tec > MiVidaTec</strong></li>
                            <li>Ve a la secci√≥n de <strong>Metas</strong></li>
                            <li>Agrega cada una de las 3 metas mostradas arriba</li>
                            <li>Personaliza los pasos seg√∫n tus necesidades</li>
                            <li>Establece fechas de seguimiento</li>
                        </ol>
                        <p><strong>Tutorial completo:</strong> <a href="https://drive.google.com/file/d/18kojUabG2z00cgmQXGU_6zLGmAL3weE9/view" target="_blank" style="color: #4285f4;">Ver tutorial de Mi Tec</a></p>
                    </div>
                    
                    <div class="email-help">
                        <h4>¬øNecesitas el correo con las recomendaciones?</h4>
                        <p>Si no recibiste el correo autom√°tico, puedes solicitarlo:</p>
                        <div class="resend-section">
                            <input type="text" id="resendMatricula" placeholder="Tu matr√≠cula" value="${results.student.matricula}">
                            <button class="btn btn-outline" onclick="resendEmail()">Solicitar Correo</button>
                        </div>
                    </div>
                </div>
            `;
            
            // Reemplazar contenido del paso 3
            document.getElementById('step3').innerHTML = '';
            document.getElementById('step3').appendChild(summaryDiv);
        }
        
        // Mostrar mensaje de √©xito con informaci√≥n del correo
        function showSuccessMessage() {
            const recommendations = generateRecommendationsData();
            
            const successDiv = document.createElement('div');
            successDiv.innerHTML = `
                <div class="success-message">
                    <div class="success-icon">‚úì</div>
                    <h2>¬°Resultados guardados exitosamente!</h2>
                    <p>Tu correo con las recomendaciones personalizadas ha sido enviado a:</p>
                    <p class="email-address"><strong>${studentData.matricula}@tec.mx</strong></p>
                    
                    <div class="next-steps">
                        <h3>Resumen de tus 3 Metas Personalizadas:</h3>
                        ${recommendations.map((rec, index) => `
                            <div style="background: white; border: 2px solid #e1e5e9; border-radius: 10px; padding: 20px; margin: 15px 0;">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                                    <h4 style="color: #333; margin: 0;">${rec.goal.title}</h4>
                                    <span style="background: ${index === 0 ? '#ea4335' : index === 1 ? '#fbbc04' : '#34a853'}; color: white; padding: 4px 8px; border-radius: 15px; font-size: 0.8em; font-weight: 600;">
                                        ${index === 0 ? 'Prioritaria' : index === 1 ? 'Complementaria' : 'Longitudinal'}
                                    </span>
                                </div>
                                <p style="color: #666; margin: 0 0 15px 0;">${rec.goal.description}</p>
                                <div style="background: #f8f9fa; padding: 10px; border-radius: 5px; font-size: 0.9em;">
                                    <strong>Pasos de acci√≥n:</strong><br>
                                    ${rec.goal.steps}
                                </div>
                            </div>
                        `).join('')}
                    </div>
                    
                    <div class="next-steps">
                        <h3>Pr√≥ximos pasos:</h3>
                        <ul>
                            <li>Revisa tu correo electr√≥nico (incluyendo spam)</li>
                            <li>Lee tus 3 metas personalizadas</li>
                            <li>Sigue el tutorial para guardarlas en Mi Tec</li>
                            <li>¬°Comienza a trabajar en ellas!</li>
                        </ul>
                    </div>
                    
                    <div class="email-help">
                        <h4>Tutorial para guardar en Mi Tec:</h4>
                        <p>Gu√≠a paso a paso para subir tus metas:</p>
                        <ol style="text-align: left; margin: 20px 0;">
                            <li>Accede a <strong>Mi Tec > MiVidaTec</strong></li>
                            <li>Ve a la secci√≥n de <strong>Metas</strong></li>
                            <li>Agrega cada una de las 3 metas mostradas arriba</li>
                            <li>Personaliza los pasos seg√∫n tus necesidades</li>
                            <li>Establece fechas de seguimiento</li>
                        </ol>
                        <p><strong>Tutorial completo:</strong> <a href="https://drive.google.com/file/d/18kojUabG2z00cgmQXGU_6zLGmAL3weE9/view" target="_blank" style="color: #4285f4;">Ver tutorial de Mi Tec</a></p>
                    </div>
                    
                    <div class="email-help">
                        <h4>¬øNo recibiste el correo?</h4>
                        <p>Verifica tu matr√≠cula y solicita el reenv√≠o:</p>
                        <div class="resend-section">
                            <input type="text" id="resendMatricula" placeholder="Tu matr√≠cula" value="${studentData.matricula}">
                            <button class="btn btn-outline" onclick="resendEmail()">Reenviar Correo</button>
                        </div>
                    </div>
                </div>
            `;
            
            // Reemplazar contenido del paso 3
            document.getElementById('step3').innerHTML = '';
            document.getElementById('step3').appendChild(successDiv);
        }
        
        // Reenviar correo
        function resendEmail() {
            const matricula = document.getElementById('resendMatricula').value.trim();
            
            if (!matricula) {
                alert('Por favor ingresa tu matr√≠cula');
                return;
            }
            
            // Mostrar loading
            const button = event.target;
            const originalText = button.textContent;
            button.textContent = 'Enviando...';
            button.disabled = true;
            
            // Enviar a Apps Script
            try {
                google.script.run
                    .withSuccessHandler((response) => {
                        button.textContent = '¬°Reenviado!';
                        button.style.background = '#4caf50';
                        
                        setTimeout(() => {
                            button.textContent = originalText;
                            button.disabled = false;
                            button.style.background = '';
                        }, 2000);
                    })
                    .withFailureHandler((error) => {
                        console.error('Error al reenviar correo:', error);
                        button.textContent = 'Error al enviar';
                        button.style.background = '#f44336';
                        
                        setTimeout(() => {
                            button.textContent = originalText;
                            button.disabled = false;
                            button.style.background = '';
                        }, 2000);
                    })
                    .resendRecommendationsEmail(matricula);
            } catch (error) {
                console.error('Error al conectar con Apps Script:', error);
                // Fallback: simular reenv√≠o
                setTimeout(() => {
                    button.textContent = '¬°Reenviado!';
                    button.style.background = '#4caf50';
                    
                    setTimeout(() => {
                        button.textContent = originalText;
                        button.disabled = false;
                        button.style.background = '';
                    }, 2000);
                }, 2000);
            }
        }

        // Inicializar cuando se carga la p√°gina
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
